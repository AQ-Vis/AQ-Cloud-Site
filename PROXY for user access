listen 80;
server_name localhost;

location ~ (/elasticsearch/.kibana/index-pattern/_search|/elasticsearch/_mget|/elasticsearch/.kibana/_mapping|/elasticsearch/_msearch)  {
	proxy_pass http://kibana:5601;
	proxy_http_version 1.1;
	proxy_set_header Upgrade $http_upgrade;
	proxy_set_header Connection "upgrade";
	proxy_set_header Host $host;
	rewrite /(.*)$ /$1 break;
}
location ~ (/elasticsearch/)  {
	return 405;
	}
location ~ (|/app/kibana|/bundles/|/status|/plugins|)  {
	if ( $request_method !~ ^(GET)$ ) {
		return 405;
	}
	proxy_pass http://kibana:5601;
	proxy_http_version 1.1;
	proxy_set_header Upgrade $http_upgrade;
	proxy_set_header Connection "upgrade";
	proxy_set_header Host $host;
	rewrite /(.*)$ /$1 break;
}
}
